"use strict";(self.webpackChunknetwork_design_web=self.webpackChunknetwork_design_web||[]).push([[3018],{"./src/stories/UVPSKUPage.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>UVPSKUPage_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),ui_button=__webpack_require__("./src/components/ui/button.tsx"),next_navigation=__webpack_require__("./.storybook/__mocks__/next-navigation.js"),scenario=__webpack_require__("./src/store/scenario.ts"),useDatabaseInformations=__webpack_require__("./src/hooks/useDatabaseInformations.tsx"),dist_module=__webpack_require__("./node_modules/react-loader-spinner/dist/module.js");var dist=__webpack_require__("./node_modules/sonner/dist/index.mjs"),v4=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js"),ui_select=__webpack_require__("./src/components/ui/select.tsx"),react_icons_esm=__webpack_require__("./node_modules/@radix-ui/react-icons/dist/react-icons.esm.js"),react_scroll_area_dist=__webpack_require__("./node_modules/@radix-ui/react-scroll-area/dist/index.mjs"),utils=__webpack_require__("./src/utils/utils.ts");const ScrollArea=react.forwardRef(({className,children,...props},ref)=>(0,jsx_runtime.jsxs)(react_scroll_area_dist.fC,{ref,className:(0,utils.cn)("relative",className),...props,children:[(0,jsx_runtime.jsx)(react_scroll_area_dist.l_,{className:"h-full w-full rounded-[inherit]",children}),(0,jsx_runtime.jsx)(ScrollBar,{}),(0,jsx_runtime.jsx)(react_scroll_area_dist.Ns,{})]}));ScrollArea.displayName=react_scroll_area_dist.fC.displayName;const ScrollBar=react.forwardRef(({className,orientation="vertical",...props},ref)=>(0,jsx_runtime.jsx)(react_scroll_area_dist.gb,{ref,orientation,className:(0,utils.cn)("flex touch-none select-none transition-colors","vertical"===orientation&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===orientation&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",className),...props,children:(0,jsx_runtime.jsx)(react_scroll_area_dist.q4,{className:"relative flex-1 rounded-full bg-border"})}));ScrollBar.displayName=react_scroll_area_dist.gb.displayName,ScrollArea.__docgenInfo={description:"",methods:[]},ScrollBar.__docgenInfo={description:"",methods:[],props:{orientation:{defaultValue:{value:"'vertical'",computed:!1},required:!1}}};var popover=__webpack_require__("./src/components/ui/popover.tsx"),command=__webpack_require__("./src/components/ui/command.tsx"),chevrons_up_down=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevrons-up-down.js"),check=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/check.js"),tooltip=__webpack_require__("./src/components/ui/tooltip.tsx");const normalize=str=>str.toLowerCase().replace(/[\s\-]+/g,"");function ScenariosUvpSkuUvp({uvps,sites,regStatus,setRegStatus,uvpChanges,setUvpChanges}){const[uvpFilters,setUvpFilters]=(0,react.useState)({}),[siteFilters,setSiteFilters]=(0,react.useState)({});return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"rounded-md bg-[#E6EEF0] p-4",children:(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-between",children:(0,jsx_runtime.jsx)("h2",{className:"text-base font-medium",children:"Set a simulation standard for UVPs"})})}),(0,jsx_runtime.jsx)("div",{className:"mt-2 rounded-md bg-white p-4 shadow-md",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"w-[200px] space-y-2",children:[(0,jsx_runtime.jsxs)("label",{htmlFor:"site",className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:["UVP Regulatory Standard",(0,jsx_runtime.jsx)(tooltip.pn,{children:(0,jsx_runtime.jsxs)(tooltip.u,{children:[(0,jsx_runtime.jsx)(tooltip.aJ,{asChild:!0,children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)(react_icons_esm.H4u,{className:"ml-1 cursor-pointer text-gray-400"})})}),(0,jsx_runtime.jsxs)(tooltip._v,{className:"max-w-xs",children:["ALL (+add): Includes all plants, ignoring regulatory restrictions and allows you to remove plants for the selected UVP.",(0,jsx_runtime.jsx)("br",{}),"Approved (+add): Uses approved plants and allows you to add more plants to the selected UVP."]})]})})]}),(0,jsx_runtime.jsxs)(ui_select.Ph,{value:regStatus,onValueChange:value=>setRegStatus(value),children:[(0,jsx_runtime.jsx)(ui_select.i4,{className:"bg-white shadow-none",children:(0,jsx_runtime.jsx)(ui_select.ki,{placeholder:"Select Default Reg Status"})}),(0,jsx_runtime.jsx)(ui_select.Bw,{children:(0,jsx_runtime.jsxs)(ScrollArea,{className:"h-auto",children:[(0,jsx_runtime.jsx)(ui_select.Ql,{value:"all",children:"All (add+)"},"all"),(0,jsx_runtime.jsx)(ui_select.Ql,{value:"approved",children:"Approved (add+)"},"approved")]})})]})]}),"all"===regStatus||"approved"===regStatus?(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(ui_button.z,{variant:"outline",className:"h-8 w-32 border-[#10384F] text-[#10384F] hover:bg-[#10384F] hover:text-white",onClick:()=>setUvpChanges([]),children:"Clear all"}),(0,jsx_runtime.jsx)(ui_button.z,{variant:"outline",className:"h-8 bg-[#10384F] text-white hover:bg-[#071c29] hover:text-white",onClick:()=>(()=>{const newChange={id:(0,v4.Z)(),uvpCode:"",uvpName:"",sites:[]},changes=[...uvpChanges,newChange];setUvpChanges(changes)})(),children:"Add UVP +"})]}):null]})}),"all"===regStatus||"approved"===regStatus?(0,jsx_runtime.jsx)("div",{className:"mt-6 rounded-md bg-white p-6 shadow-md",children:(0,jsx_runtime.jsx)("div",{className:"max-h-[300px] overflow-y-auto",children:(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[uvpChanges.map(change=>{var _uvps_find;const sitesList=sites.filter(site=>{const belongsToUvp=String(site.uvp)===String(change.uvpCode),notAlreadySelected=!change.sites.some(s=>s.id===site.id);if("YES"===site.restriction){const hasNoRestrictionVersion=sites.some(s=>s.sap===site.sap&&s.uvp===site.uvp&&"NO"===s.restriction);return belongsToUvp&&notAlreadySelected&&!hasNoRestrictionVersion}return belongsToUvp&&notAlreadySelected});return(0,jsx_runtime.jsxs)("div",{className:"rounded-md bg-[#F8F9FA] p-4 flex items-center justify-between gap-2",children:[(0,jsx_runtime.jsxs)("section",{className:"flex items-top gap-2",children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)("label",{htmlFor:"uvp",className:"text-sm font-medium text-gray-700",children:"UVP"}),(0,jsx_runtime.jsxs)(popover.J2,{children:[(0,jsx_runtime.jsx)(popover.xo,{asChild:!0,children:(0,jsx_runtime.jsxs)(ui_button.z,{variant:"outline",role:"combobox",className:"bg-white shadow-none w-auto min-w-[200px] h-auto flex justify-between",children:[change.uvpCode?null===(_uvps_find=uvps.find(u=>u.uvpCode===change.uvpCode))||void 0===_uvps_find?void 0:_uvps_find.label:"Select UVP...",(0,jsx_runtime.jsx)(chevrons_up_down.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,jsx_runtime.jsx)(popover.yk,{className:"w-[300px] p-0",children:(0,jsx_runtime.jsxs)(command.mY,{children:[(0,jsx_runtime.jsx)(command.sZ,{placeholder:"Search UVP...",value:uvpFilters[change.id]||"",onValueChange:value=>setUvpFilters(f=>({...f,[change.id]:value}))}),(0,jsx_runtime.jsxs)(command.e8,{children:[(0,jsx_runtime.jsx)(command.rb,{children:"No UVP found."}),(0,jsx_runtime.jsx)(command.fu,{children:uvps.filter(item=>(!item.uvpCode||!uvpChanges.some(other=>other.id!==change.id&&other.uvpCode===item.uvpCode))&&(""===(uvpFilters[change.id]||"")||normalize(item.label).includes(normalize(uvpFilters[change.id]||"")))).map(uvp=>(0,jsx_runtime.jsxs)(command.di,{value:uvp.label,onSelect:()=>{((id,uvpCode)=>{const uvp=uvps.find(uvp=>uvp.uvpCode===uvpCode);if(!uvp)return void dist.Am.error("UVP not found in database");let sitesForUvp=[];sitesForUvp="all"===regStatus?sites.filter(d=>String(d.uvp)===String(uvpCode)):sites.filter(d=>String(d.uvp)===String(uvpCode)&&"NO"===d.restriction);const change=uvpChanges.map(change=>change.id===id?{...change,uvpCode:uvp.uvpCode,uvpName:uvp.uvpName,sites:sitesForUvp}:change);setUvpChanges(change)})(change.id,uvp.uvpCode),setUvpFilters(f=>({...f,[change.id]:""}))},children:[(0,jsx_runtime.jsx)(check.Z,{className:(0,utils.cn)("mr-2 h-4 w-4",change.uvpCode===uvp.uvpCode?"opacity-100":"opacity-0")}),uvp.label]},uvp.id))})]})]})})]})]}),(0,jsx_runtime.jsxs)("div",{className:"space-y-2",children:[(0,jsx_runtime.jsx)("label",{htmlFor:"sites",className:"text-sm font-medium text-gray-700",children:"Sites"}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap gap-2 border rounded-md p-2 bg-white mr-5",children:[change.sites.map((site,index)=>(0,jsx_runtime.jsxs)("div",{className:`flex items-center ${"YES"===site.restriction?"bg-gray-100  text-[#10384F]":"bg-[#10384f] text-white"} px-2 py-1 rounded-md text-sm`,children:[site.label,(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>((id,siteIndex)=>{const change=uvpChanges.map(change=>change.id===id?{...change,sites:change.sites.filter((_,index)=>index!==siteIndex)}:change);setUvpChanges(change)})(change.id,index),className:"ml-1 text-[#10384F] hover:text-red-600",children:(0,jsx_runtime.jsx)(react_icons_esm.Pxu,{className:"h-3 w-3"})})]},index)),sitesList.length>0||!change.uvpCode?(0,jsx_runtime.jsxs)(popover.J2,{children:[(0,jsx_runtime.jsx)(popover.xo,{asChild:!0,children:(0,jsx_runtime.jsxs)(ui_button.z,{variant:"outline",role:"combobox",className:"w-auto h-auto bg-transparent text-left shadow-none flex justify-between",disabled:""===change.uvpCode,children:["Add Site...",(0,jsx_runtime.jsx)(chevrons_up_down.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,jsx_runtime.jsx)(popover.yk,{className:"w-[400px] p-0",children:(0,jsx_runtime.jsxs)(command.mY,{children:[(0,jsx_runtime.jsx)(command.sZ,{placeholder:"Search site...",value:siteFilters[change.id]||"",onValueChange:value=>setSiteFilters(f=>({...f,[change.id]:value}))}),(0,jsx_runtime.jsxs)(command.e8,{children:[(0,jsx_runtime.jsx)(command.rb,{children:"No site found."}),(0,jsx_runtime.jsx)(command.fu,{children:sitesList.filter(site=>""===(siteFilters[change.id]||"")||normalize(site.label).includes(normalize(siteFilters[change.id]||""))).map(site=>(0,jsx_runtime.jsxs)(command.di,{value:site.id,onSelect:()=>{((id,value)=>{const decodedId=(0,utils.xM)(value),[sap,name,restriction,uvp]=decodedId.split("@"),site={id:value,sap,name,uvp,restriction,label:`${sap} - ${name}`},change=uvpChanges.map(change=>change.id===id?{...change,sites:[...change.sites,site]}:change);setUvpChanges(change)})(change.id,site.id),setSiteFilters(f=>({...f,[change.id]:""}))},children:[(0,jsx_runtime.jsx)(check.Z,{className:(0,utils.cn)("mr-2 h-4 w-4",change.sites.some(s=>s.id===site.id)?"opacity-100":"opacity-0")}),site.label]},site.id))})]})]})})]}):null]})]})]}),(0,jsx_runtime.jsx)("section",{className:"mr-4",children:(0,jsx_runtime.jsx)("div",{className:"flex items-center",children:(0,jsx_runtime.jsx)(ui_button.z,{variant:"ghost",size:"sm",onClick:()=>(id=>{const remove=uvpChanges.filter(change=>change.id!==id);setUvpChanges(remove)})(change.id),className:"h-10 w-10 p-0 text-gray-500 hover:text-red-600 bg-[#E6EEF0]",children:(0,jsx_runtime.jsx)(react_icons_esm.XHJ,{className:"h-5 w-5 text-gray-700"})})})})]},change.id)}),0===uvpChanges.length&&(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:(0,jsx_runtime.jsx)("p",{className:"p-8 font-medium text-gray-600",children:"No changes applied"})})]})})}):null]})}ScenariosUvpSkuUvp.__docgenInfo={description:"",methods:[],displayName:"ScenariosUvpSkuUvp",props:{uvps:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string; \r\n  uvpName: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"uvpName",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"UvpItem[]"},description:""},sites:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  sap: string;\r\n  name: string;\r\n  uvp: string;\r\n  restriction: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"sap",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"uvp",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"SiteItem[]"},description:""},regStatus:{required:!0,tsType:{name:"string"},description:""},setRegStatus:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},uvpChanges:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  uvpName: string;\r\n  sites: SiteItem[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"uvpName",value:{name:"string",required:!0}},{key:"sites",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  sap: string;\r\n  name: string;\r\n  uvp: string;\r\n  restriction: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"sap",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"uvp",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"SiteItem[]",required:!0}}]}}],raw:"UvpChange[]"},description:""},setUvpChanges:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: UvpChange[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  uvpName: string;\r\n  sites: SiteItem[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"uvpName",value:{name:"string",required:!0}},{key:"sites",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  sap: string;\r\n  name: string;\r\n  uvp: string;\r\n  restriction: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"sap",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"uvp",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"SiteItem[]",required:!0}}]}}],raw:"UvpChange[]"},name:"value"}],return:{name:"void"}}},description:""}}};var input=__webpack_require__("./src/components/ui/input.tsx");const uvpsku_sku_normalize=str=>str.toLowerCase().replace(/[\s\-]+/g,"");function ScenariosUvpSkuSku({database,uvps,skus,skusSites,uvpChanges,skuChanges,setSkuChanges,regStatus}){const[skuUvpFilters,setSkuUvpFilters]=(0,react.useState)({}),[skuFilters,setSkuFilters]=(0,react.useState)({}),[definedSetFilters,setDefinedSetFilters]=(0,react.useState)({});return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"rounded-md bg-[#E6EEF0] p-4",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsxs)("h2",{className:"text-base font-medium inline-flex items-center",children:["Fix SKU in a scenario",(0,jsx_runtime.jsx)(tooltip.pn,{children:(0,jsx_runtime.jsxs)(tooltip.u,{children:[(0,jsx_runtime.jsx)(tooltip.aJ,{asChild:!0,children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)(react_icons_esm.H4u,{className:"ml-1 cursor-pointer text-gray-400"})})}),(0,jsx_runtime.jsx)(tooltip._v,{className:"max-w-xs",children:"If desired, fix one or more SKUs to one or more sites: the simulation will not modify the fixed SKUs."})]})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(ui_button.z,{variant:"outline",className:"h-8 w-32 border-[#10384F] text-[#10384F] hover:bg-[#10384F] hover:text-white",onClick:()=>setSkuChanges([]),children:"Clear all"}),(0,jsx_runtime.jsx)(ui_button.z,{variant:"outline",className:"h-8 bg-[#10384F] text-white hover:bg-[#071c29] hover:text-white",onClick:()=>(()=>{const newChange={id:(0,v4.Z)(),uvpCode:"",skus:[],open:!1},changes=[...skuChanges,newChange];setSkuChanges(changes)})(),children:"Add SKU +"})]})]})}),(0,jsx_runtime.jsx)("div",{className:"mt-6 rounded-md bg-white p-6 shadow-md",children:(0,jsx_runtime.jsx)("div",{className:"h-auto overflow-y-auto overflow-x-hidden",children:(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[skuChanges.map(item=>{var _uvps_find;return(0,jsx_runtime.jsx)("div",{className:"rounded-md p-1",children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:"grid h-[120px] h-auto grid-cols-1 gap-2 rounded-md bg-[#F8F9FA] p-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-md font-medium text-gray-900",children:"UVP"}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(ui_button.z,{variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>(id=>{const change=skuChanges.map(change=>change.id===id?{...change,open:!change.open}:{...change,open:!1});setSkuChanges(change)})(item.id),disabled:0===item.skus.length||""===item.uvpCode,children:item.open?(0,jsx_runtime.jsx)(react_icons_esm.XCv,{className:"h-7 w-7"}):(0,jsx_runtime.jsx)(react_icons_esm.wyc,{className:"h-7 w-7"})})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 justify-between items-center flex-wrap",children:[(0,jsx_runtime.jsxs)(popover.J2,{children:[(0,jsx_runtime.jsx)(popover.xo,{asChild:!0,children:(0,jsx_runtime.jsxs)(ui_button.z,{variant:"outline",role:"combobox",className:"bg-white min-w-[30%] w-auto shadow-none flex justify-between",children:[item.uvpCode?null===(_uvps_find=uvps.find(u=>u.uvpCode===item.uvpCode))||void 0===_uvps_find?void 0:_uvps_find.label:"Select UVP...",(0,jsx_runtime.jsx)(chevrons_up_down.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,jsx_runtime.jsx)(popover.yk,{className:"w-[300px] p-0",children:(0,jsx_runtime.jsxs)(command.mY,{children:[(0,jsx_runtime.jsx)(command.sZ,{placeholder:"Search UVP...",value:skuUvpFilters[item.id]||"",onValueChange:value=>setSkuUvpFilters(f=>({...f,[item.id]:value}))}),(0,jsx_runtime.jsxs)(command.e8,{children:[(0,jsx_runtime.jsx)(command.rb,{children:"No UVP found."}),(0,jsx_runtime.jsx)(command.fu,{children:uvps.filter(uvp=>{const input=uvpsku_sku_normalize(skuUvpFilters[item.id]||""),label=uvpsku_sku_normalize(uvp.label);return""===input||label.includes(input)}).map(uvp=>(0,jsx_runtime.jsxs)(command.di,{value:uvp.label,disabled:skuChanges.some(i=>String(i.uvpCode)===String(uvp.uvpCode)),onSelect:()=>{((id,uvpCode)=>{const change=skuChanges.map(change=>change.id===id?{...change,open:!1,uvpCode,skus:[]}:change);setSkuChanges(change)})(item.id,uvp.uvpCode),setSkuUvpFilters(f=>({...f,[item.id]:""}))},children:[(0,jsx_runtime.jsx)(check.Z,{className:(0,utils.cn)("mr-2 h-4 w-4",item.uvpCode===uvp.uvpCode?"opacity-100":"opacity-0")}),uvp.label]},uvp.id))})]})]})})]}),(0,jsx_runtime.jsxs)("section",{className:"w-auto flex gap-2",children:[(0,jsx_runtime.jsx)(ui_button.z,{variant:"outline",onClick:()=>(id=>{const remove=skuChanges.map(change=>change.id===id?{...change,skus:[],open:!1}:change);setSkuChanges(remove)})(item.id),className:"h-[50px] w-[60px] border-[#10384F] p-2 text-center text-[#10384F] hover:bg-[#10384F] hover:text-white",disabled:0===item.skus.length||""===item.uvpCode,children:"Clear All"}),(0,jsx_runtime.jsx)(ui_button.z,{onClick:()=>((id,uvpCode)=>{const formatSkus=skus.filter(s=>String(s.uvpCode)===String(uvpCode)).map(sku=>{const findSku=database.find(s=>String(s.uvp)===String(uvpCode)&&String(s.sku_code)===String(sku.skuCode)&&!0===s.current_state);return findSku?"approved"===regStatus&&"NO"!==findSku.reg_restriction?null:{id:sku.id,uvpCode:sku.uvpCode,skuCode:sku.skuCode,skuName:sku.skuName,cenario:findSku.cenario,restriction:findSku.reg_restriction,defined_set:[]}:null}).filter(f=>null!==f);if(0===formatSkus.length)return void dist.Am.error("No SKUs found for this UVP, please check the UVP code and try again");const skuChangeUpdate=skuChanges.map(change=>change.id===id?{...change,open:!0,skus:formatSkus}:{...change,open:!1});setSkuChanges(skuChangeUpdate)})(item.id,item.uvpCode),className:"h-[50px] w-[90px] bg-[#10384F] p-2 text-center text-white hover:bg-[#071c29]",disabled:""===item.uvpCode,children:"Add All SKU"}),(0,jsx_runtime.jsx)(ui_button.z,{onClick:()=>((id,uvpCode)=>{const sku={id:(0,v4.Z)(),uvpCode,skuCode:"",skuName:"",cenario:"",restriction:"",defined_set:[]},change=skuChanges.map(change=>change.id===id?{...change,open:!0,skus:[...change.skus,sku]}:{...change,open:!1});setSkuChanges(change)})(item.id,item.uvpCode),className:"h-[50px] w-[80px] bg-[#10384F] p-2 text-center text-white hover:bg-[#071c29]",disabled:""===item.uvpCode,children:"Add SKU +"})]})]})]}),item.open&&(0,jsx_runtime.jsx)("div",{children:item.skus.map(sku=>{var _skus_find;const skuList=skus.filter(s=>String(s.uvpCode)===String(item.uvpCode)),uvpChange=uvpChanges.find(change=>String(change.uvpCode)===String(item.uvpCode));let availableSites=skusSites.filter(s=>String(s.uvpCode)===String(item.uvpCode)&&String(s.skuCode)===String(sku.skuCode)&&!sku.defined_set.some(set=>set.id===s.id));if("approved"===regStatus)if(uvpChange&&uvpChange.sites.length>0){const selectedSapCodes=uvpChange.sites.map(site=>site.sap);availableSites=availableSites.filter(site=>selectedSapCodes.includes(site.sapCode))}else availableSites=availableSites.filter(site=>"NO"===site.restriction);else if("all"===regStatus&&uvpChange&&uvpChange.sites.length>0){const selectedSapCodes=uvpChange.sites.map(site=>site.sap);availableSites=availableSites.filter(site=>selectedSapCodes.includes(site.sapCode))}return(0,jsx_runtime.jsxs)("div",{className:"flex justify-between items-center p-4 mt-2 rounded-md bg-white border border-gray-200 shadow",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 min-w-[40%] w-auto",children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-2 w-auto",children:[(0,jsx_runtime.jsxs)("label",{htmlFor:"uvp",className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:["SKU",(0,jsx_runtime.jsx)("span",{className:"ml-1 opacity-0",children:(0,jsx_runtime.jsx)(react_icons_esm.H4u,{})})]}),(0,jsx_runtime.jsxs)(popover.J2,{children:[(0,jsx_runtime.jsx)(popover.xo,{asChild:!0,children:(0,jsx_runtime.jsxs)(ui_button.z,{variant:"outline",role:"combobox",className:"bg-white h-auto shadow-none flex justify-between",children:[sku.skuCode?null===(_skus_find=skus.find(s=>s.skuCode===sku.skuCode))||void 0===_skus_find?void 0:_skus_find.label:"Select SKU...",(0,jsx_runtime.jsx)(chevrons_up_down.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,jsx_runtime.jsx)(popover.yk,{className:"w-[300px] p-0",children:(0,jsx_runtime.jsxs)(command.mY,{children:[(0,jsx_runtime.jsx)(command.sZ,{placeholder:"Search SKU...",value:skuFilters[item.id]||"",onValueChange:value=>setSkuFilters(f=>({...f,[item.id]:value}))}),(0,jsx_runtime.jsxs)(command.e8,{children:[(0,jsx_runtime.jsx)(command.rb,{children:"No SKU found."}),(0,jsx_runtime.jsx)(command.fu,{children:skuList.filter(skk=>{const input=uvpsku_sku_normalize(skuFilters[item.id]||""),label=uvpsku_sku_normalize(String(skk.label));return""===input||label.includes(input)}).map(skk=>(0,jsx_runtime.jsxs)(command.di,{value:skk.label,onSelect:()=>{((id,changeId,skuId)=>{const decodedSku=(0,utils.xM)(skuId),[uvpCode,skuCode,skuName]=decodedSku.split("@"),findSku=database.find(s=>String(s.uvp)===String(uvpCode)&&String(s.sku_code)===String(skuCode)&&!0===s.current_state);if(findSku){const sku={id:skuId,uvpCode,skuCode,skuName,cenario:findSku.cenario,restriction:findSku.reg_restriction,defined_set:[]},skuChangeUpdate=skuChanges.map(change=>change.id===id?{...change,skus:change.skus.map(s=>s.id===changeId?{...s,...sku}:s)}:change);setSkuChanges(skuChangeUpdate)}else dist.Am.error("SKU not found, please check the SKU code and try again")})(item.id,sku.id,skk.id),setSkuFilters(f=>({...f,[item.id]:""}))},children:[(0,jsx_runtime.jsx)(check.Z,{className:(0,utils.cn)("mr-2 h-4 w-4",sku.skuCode===skk.skuCode?"opacity-100":"opacity-0")}),skk.label]},skk.id))})]})]})})]})]}),(0,jsx_runtime.jsxs)("div",{className:"space-y-2 w-auto",children:[(0,jsx_runtime.jsxs)("label",{htmlFor:"site",className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:["Current Set",(0,jsx_runtime.jsx)(tooltip.pn,{children:(0,jsx_runtime.jsxs)(tooltip.u,{children:[(0,jsx_runtime.jsx)(tooltip.aJ,{asChild:!0,children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)(react_icons_esm.H4u,{className:"ml-1 cursor-pointer text-gray-400"})})}),(0,jsx_runtime.jsx)(tooltip._v,{children:"Formulation plant - Filling Plant"})]})})]}),(0,jsx_runtime.jsx)(input.I,{className:"h-auto bg-white shadow-none min-h-[35px]",value:sku.cenario,disabled:!0})]}),(0,jsx_runtime.jsxs)("div",{className:"space-y-2 min-w-[25%] w-auto",children:[(0,jsx_runtime.jsxs)("label",{htmlFor:"uvp",className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:["Fixed Sites",(0,jsx_runtime.jsx)(tooltip.pn,{children:(0,jsx_runtime.jsxs)(tooltip.u,{children:[(0,jsx_runtime.jsx)(tooltip.aJ,{asChild:!0,children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)(react_icons_esm.H4u,{className:"ml-1 cursor-pointer text-gray-400"})})}),(0,jsx_runtime.jsx)(tooltip._v,{children:"Fixed sites : formulation-filling"})]})})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap gap-2 border rounded-md p-2 bg-white min-h-[35px]",children:[sku.defined_set.map((set,index)=>(0,jsx_runtime.jsxs)("div",{className:`flex items-center ${"YES"===set.restriction?"bg-gray-100  text-[#10384F]":"bg-[#10384f] text-white"} px-2 py-1 rounded-md text-sm`,children:[set.label,(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>((id,skuId,setId)=>{const remove=skuChanges.map(change=>change.id===id?{...change,skus:change.skus.map(s=>s.id===skuId?{...s,defined_set:s.defined_set.filter(s=>s.id!==setId)}:s)}:change);setSkuChanges(remove)})(item.id,sku.id,set.id),className:"ml-1 text-[#10384F] hover:text-red-600",children:(0,jsx_runtime.jsx)(react_icons_esm.Pxu,{className:"h-3 w-3 text-white"})})]},set.id)),availableSites.length>0?(0,jsx_runtime.jsx)("div",{className:"flex-1 min-w-[300px]",children:(0,jsx_runtime.jsxs)(popover.J2,{children:[(0,jsx_runtime.jsx)(popover.xo,{asChild:!0,children:(0,jsx_runtime.jsxs)(ui_button.z,{variant:"outline",role:"combobox",className:"w-[200px] bg-transparent text-left shadow-none flex justify-between",disabled:""===sku.skuCode,children:["Select defined sets",(0,jsx_runtime.jsx)(chevrons_up_down.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,jsx_runtime.jsx)(popover.yk,{className:"w-[200px] p-0",children:(0,jsx_runtime.jsxs)(command.mY,{children:[(0,jsx_runtime.jsx)(command.sZ,{placeholder:"Search set...",value:definedSetFilters[sku.id]||"",onValueChange:value=>setDefinedSetFilters(f=>({...f,[sku.id]:value}))}),(0,jsx_runtime.jsxs)(command.e8,{children:[(0,jsx_runtime.jsx)(command.rb,{children:"No set found."}),(0,jsx_runtime.jsx)(command.fu,{children:availableSites.filter(site=>{const input=uvpsku_sku_normalize(definedSetFilters[sku.id]||""),label=uvpsku_sku_normalize(site.label);return""===input||label.includes(input)}).map(site=>(0,jsx_runtime.jsxs)(command.di,{value:site.label,onSelect:()=>{((id,skuId,set)=>{const decodedSet=(0,utils.xM)(set),[sapCode,uvpCode,skuCode,cenario,restriction]=decodedSet.split("@"),newSet={id:set,cenario,restriction,label:cenario},add=skuChanges.map(change=>change.id===id?{...change,skus:change.skus.map(s=>s.id===skuId?{...s,defined_set:[...s.defined_set,newSet]}:s)}:change);setSkuChanges(add)})(item.id,sku.id,site.id),setDefinedSetFilters(f=>({...f,[sku.id]:""}))},children:[(0,jsx_runtime.jsx)(check.Z,{className:(0,utils.cn)("mr-2 h-4 w-4",sku.defined_set.some(set=>set.id===site.id)?"opacity-100":"opacity-0")}),site.label]},site.id))})]})]})})]})}):null]})]})]}),(0,jsx_runtime.jsx)("div",{className:"w-auto mr-4",children:(0,jsx_runtime.jsx)(ui_button.z,{variant:"ghost",size:"sm",onClick:()=>((id,skuId)=>{const remove=skuChanges.map(change=>change.id===id?{...change,skus:change.skus.filter(sku=>sku.id!==skuId)}:change);setSkuChanges(remove)})(item.id,sku.id),className:"h-10 w-10 p-0 text-gray-500 hover:text-red-600 bg-[#E6EEF0]",children:(0,jsx_runtime.jsx)(react_icons_esm.XHJ,{className:"h-5 w-5 text-gray-700"})})})]},`${sku.id}`)})})]})},item.id)}),0===skuChanges.length&&(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:(0,jsx_runtime.jsx)("p",{className:"p-8 font-medium text-gray-600",children:"No changes applied"})})]})})})]})}function parseNumberBR(value){return Number("string"==typeof value?value.replace(/\./g,"").replace(",","."):value)}function ScenariosUvpSkuView(){var _data_snapshot,_data_uvpsku,_data_uvpsku1,_data_uvpsku2;const router=(0,next_navigation.t)(),{data,update}=(0,scenario.r)(),snapshotName=null===(_data_snapshot=data.snapshot)||void 0===_data_snapshot?void 0:_data_snapshot.name,{database,uvps,sites,skus,skusSites,isLoading:loading}=(0,useDatabaseInformations.Q)(snapshotName),[loadingCreate,setLoadingCreate]=(0,react.useState)(!1);var _data_uvpsku_default;const[regStatus,setRegStatus]=(0,react.useState)(null!==(_data_uvpsku_default=null===(_data_uvpsku=data.uvpsku)||void 0===_data_uvpsku?void 0:_data_uvpsku.default)&&void 0!==_data_uvpsku_default?_data_uvpsku_default:"all");var _data_uvpsku_uvps;const[uvpChanges,setUvpChanges]=(0,react.useState)(null!==(_data_uvpsku_uvps=null===(_data_uvpsku1=data.uvpsku)||void 0===_data_uvpsku1?void 0:_data_uvpsku1.uvps)&&void 0!==_data_uvpsku_uvps?_data_uvpsku_uvps:[]);var _data_uvpsku_skus;const[skuChanges,setSkuChanges]=(0,react.useState)(null!==(_data_uvpsku_skus=null===(_data_uvpsku2=data.uvpsku)||void 0===_data_uvpsku2?void 0:_data_uvpsku2.skus)&&void 0!==_data_uvpsku_skus?_data_uvpsku_skus:[]);return(0,jsx_runtime.jsxs)("div",{className:"min-h-screen w-full",children:[loading?(0,jsx_runtime.jsx)("div",{className:"flex h-screen w-full items-center justify-center",children:(0,jsx_runtime.jsx)(dist_module.iT,{visible:!0,height:"80",width:"80",color:"#175072",secondaryColor:"#10384F"})}):null,loadingCreate?(0,jsx_runtime.jsxs)("div",{className:"flex h-screen w-full items-center justify-center flex-col",children:[(0,jsx_runtime.jsx)(dist_module.iT,{visible:!0,height:"80",width:"80",color:"#175072",secondaryColor:"#10384F"}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("p",{className:"text-lg font-medium",children:"Scenario is being created, please wait a few minutes."}),(0,jsx_runtime.jsx)("p",{className:"text-sm text-gray-500",children:"This may take up to 5 minutes"})]}):null,loadingCreate||loading?null:(0,jsx_runtime.jsxs)("div",{className:"h-full w-full space-y-6 overflow-auto p-6",children:[snapshotName&&(0,jsx_runtime.jsx)("div",{className:"rounded-md bg-[#E6EEF0] p-4",children:(0,jsx_runtime.jsx)("span",{className:"text-sm font-semibold text-[#10384F]",children:snapshotName})}),(0,jsx_runtime.jsx)(ScenariosUvpSkuUvp,{uvps,sites,uvpChanges,setUvpChanges:data=>{setUvpChanges(data),update({uvpsku:{default:regStatus,uvps:data,skus:skuChanges}})},regStatus,setRegStatus:value=>{setRegStatus(value),update({uvpsku:{default:value,uvps:uvpChanges,skus:skuChanges}})}}),(0,jsx_runtime.jsx)(ScenariosUvpSkuSku,{database,uvps,skus,skusSites,uvpChanges,skuChanges,setSkuChanges:data=>{setSkuChanges(data),update({uvpsku:{default:regStatus,uvps:uvpChanges,skus:data}})},regStatus}),(0,jsx_runtime.jsxs)("div",{className:"sticky bottom-0 mt-6 flex justify-end py-4",children:[(0,jsx_runtime.jsx)(ui_button.z,{className:"bg-[#10384F] text-white hover:bg-[#071c29]",onClick:()=>router.back(),children:"Back"}),(0,jsx_runtime.jsx)(ui_button.z,{onClick:async()=>{var _data_uvpsku,_data_uvpsku1,_data_scenario_changes;setLoadingCreate(!0);const capacityChanges=null!==(_data_scenario_changes=data.scenario.changes)&&void 0!==_data_scenario_changes?_data_scenario_changes:[];var _data_uvpsku_skus;const skusChanges=null!==(_data_uvpsku_skus=null===(_data_uvpsku=data.uvpsku)||void 0===_data_uvpsku?void 0:_data_uvpsku.skus)&&void 0!==_data_uvpsku_skus?_data_uvpsku_skus:[];var _data_uvpsku_uvps;const uvpChanges=null!==(_data_uvpsku_uvps=null===(_data_uvpsku1=data.uvpsku)||void 0===_data_uvpsku1?void 0:_data_uvpsku1.uvps)&&void 0!==_data_uvpsku_uvps?_data_uvpsku_uvps:[];let filteredDatabase=database;const handleTechRestriction=item=>{var _change_tech_restriction;if(!capacityChanges.length)return"YES"===String(item.tech_restriction).toUpperCase();const change=capacityChanges.find(c=>String(c.plant_sap)===String(item.plant_sap));return!change||("YES"!==(null===(_change_tech_restriction=change.tech_restriction)||void 0===_change_tech_restriction?void 0:_change_tech_restriction.toUpperCase())||"YES"===String(item.tech_restriction).toUpperCase())};let format=[];const processedKeys=new Set;for(const skuChanged of skusChanges){if(!skuChanged.uvpCode||!skuChanged.skus.length)continue;const uvpChange=uvpChanges.find(uvp=>String(uvp.uvpCode)===String(skuChanged.uvpCode));for(const sku of skuChanged.skus)if(sku.defined_set&&sku.defined_set.length>0)for(const set of sku.defined_set){const dbItem=filteredDatabase.find(db=>String(db.uvp)===String(skuChanged.uvpCode)&&String(db.sku_code)===String(sku.skuCode)&&String(db.cenario)===String(set.cenario));if(!dbItem)continue;var _dbItem_sap_code,_ref,_ref1;const itemSap=null!==(_ref1=null!==(_ref=null!==(_dbItem_sap_code=dbItem.sap_code)&&void 0!==_dbItem_sap_code?_dbItem_sap_code:dbItem.plant_sap)&&void 0!==_ref?_ref:dbItem.formulation_plant)&&void 0!==_ref1?_ref1:dbItem.comm_plant,definedSite=uvpChange&&uvpChange.sites.length>0?uvpChange.sites.map(site=>site.sap):null;if(definedSite&&!definedSite.includes(itemSap))continue;const key=`${dbItem.uvp}_${dbItem.sku_code}_${dbItem.cenario}`;if(processedKeys.has(key))continue;if(processedKeys.add(key),!handleTechRestriction(dbItem))continue;const gCapacidade=capacityChanges.find(c=>{var _dbItem_sap_code,_ref,_ref1;return String(c.plant_sap)===String(null!==(_ref1=null!==(_ref=null!==(_dbItem_sap_code=dbItem.sap_code)&&void 0!==_dbItem_sap_code?_dbItem_sap_code:dbItem.plant_sap)&&void 0!==_ref?_ref:dbItem.formulation_plant)&&void 0!==_ref1?_ref1:dbItem.comm_plant)&&String(c.line)===String(dbItem.line)});let capacidade=gCapacidade?String(gCapacidade.capacidade).replace(".","").replace(",","."):dbItem.capacidade;format.push({uvp:Number(dbItem.uvp),sku_code:Number(dbItem.sku_code),sku:String(dbItem.sku),current_state:String(dbItem.current_state),line:String(dbItem.line),cenario:String(dbItem.cenario),capacidade:parseNumberBR(capacidade),custo_unitario:parseNumberBR(dbItem.custo_unitario)})}}for(const item of filteredDatabase){var _data_uvpsku2;const uvpChange=uvpChanges.find(uvp=>String(uvp.uvpCode)===String(item.uvp)),skuChanged=skusChanges.find(s=>String(s.uvpCode)===String(item.uvp)),key=`${item.uvp}_${item.sku_code}_${item.cenario}`;if(processedKeys.has(key))continue;if(!handleTechRestriction(item))continue;if(skuChanged){if(skuChanged.skus.some(s=>String(s.skuCode)===String(item.sku_code)&&s.defined_set&&s.defined_set.length>0))continue;if(uvpChange&&uvpChange.sites.length>0){var _item_sap_code,_ref2,_ref3;const itemSap=null!==(_ref3=null!==(_ref2=null!==(_item_sap_code=item.sap_code)&&void 0!==_item_sap_code?_item_sap_code:item.plant_sap)&&void 0!==_ref2?_ref2:item.formulation_plant)&&void 0!==_ref3?_ref3:item.comm_plant;if(!uvpChange.sites.some(site=>site.sap===itemSap))continue}}else if(uvpChange&&uvpChange.sites.length>0){var _item_sap_code1,_ref4,_ref5;const itemSap=null!==(_ref5=null!==(_ref4=null!==(_item_sap_code1=item.sap_code)&&void 0!==_item_sap_code1?_item_sap_code1:item.plant_sap)&&void 0!==_ref4?_ref4:item.formulation_plant)&&void 0!==_ref5?_ref5:item.comm_plant;if(!uvpChange.sites.some(site=>site.sap===itemSap))continue}if(!("approved"!==(null===(_data_uvpsku2=data.uvpsku)||void 0===_data_uvpsku2?void 0:_data_uvpsku2.default)||uvpChange&&uvpChange.sites.length&&uvpChange.sites.some(site=>{var _item_sap_code,_ref,_ref1;return site.sap===(null!==(_ref1=null!==(_ref=null!==(_item_sap_code=item.sap_code)&&void 0!==_item_sap_code?_item_sap_code:item.plant_sap)&&void 0!==_ref?_ref:item.formulation_plant)&&void 0!==_ref1?_ref1:item.comm_plant)}))&&"NO"!==item.reg_restriction)continue;const gCapacidade=capacityChanges.find(c=>{var _item_sap_code,_ref,_ref1;return String(c.plant_sap)===String(null!==(_ref1=null!==(_ref=null!==(_item_sap_code=item.sap_code)&&void 0!==_item_sap_code?_item_sap_code:item.plant_sap)&&void 0!==_ref?_ref:item.formulation_plant)&&void 0!==_ref1?_ref1:item.comm_plant)&&String(c.line)===String(item.line)});let capacidade=gCapacidade?String(gCapacidade.capacidade).replace(".","").replace(",","."):item.capacidade;format.push({uvp:Number(item.uvp),sku_code:Number(item.sku_code),sku:String(item.sku),current_state:String(item.current_state),line:String(item.line),cenario:String(item.cenario),capacidade:parseNumberBR(capacidade),custo_unitario:parseNumberBR(item.custo_unitario)})}const body={application:data,input:format},create=await async function createScenario(scenario){const response=await fetch("http://localhost:5000/scenario",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(scenario)});var _returnData_message;return response.ok?{success:!0,message:"Scenario created successfully",data:await response.json()}:{success:!1,message:null!==(_returnData_message=(await response.json()).message)&&void 0!==_returnData_message?_returnData_message:`Error: ${response.status} - ${response.statusText}`}}(body);if(create.success){dist.Am.success("Scenario is being created, please wait a few minutes.");const currentSnapshotId=data.snapshot.id;router.push(`/?snapshot=${currentSnapshotId}`)}else dist.Am.error("Error creating scenario, review parameters.");setLoadingCreate(!1)},disabled:loadingCreate,className:"ml-2 rounded-md bg-[#10384F] px-4 py-2 text-sm font-medium text-white hover:bg-[#071c29]",children:"Run Scenario"})]})]})]})}ScenariosUvpSkuSku.__docgenInfo={description:"",methods:[],displayName:"ScenariosUvpSkuSku",props:{database:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id?: string;\r\n  \r\n  formulation_plant: string;\r\n  formulation_plant_name: string;\r\n  filling_plant: string;\r\n  comm_plant: string;\r\n  current_state: boolean;\r\n  uvp: number;\r\n  unpacked_goods_uvp_1: string;\r\n  sku_code: number;\r\n  sku: string;\r\n  plant_name: string;\r\n  technology: string;\r\n  business_unit: string;\r\n  custo_unitario: number;\r\n  reg_restriction: string;\r\n  plant_sap: string;\r\n  indication_x: string;\r\n  main_technology_cluster: string;\r\n  capacidade: string | number | null;\r\n  sap_code: string;\r\n  indication_y: string;\r\n  capability: string;\r\n  tech_restriction: string;\r\n  cenario: string;\r\n  line: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!1}},{key:"formulation_plant",value:{name:"string",required:!0}},{key:"formulation_plant_name",value:{name:"string",required:!0}},{key:"filling_plant",value:{name:"string",required:!0}},{key:"comm_plant",value:{name:"string",required:!0}},{key:"current_state",value:{name:"boolean",required:!0}},{key:"uvp",value:{name:"number",required:!0}},{key:"unpacked_goods_uvp_1",value:{name:"string",required:!0}},{key:"sku_code",value:{name:"number",required:!0}},{key:"sku",value:{name:"string",required:!0}},{key:"plant_name",value:{name:"string",required:!0}},{key:"technology",value:{name:"string",required:!0}},{key:"business_unit",value:{name:"string",required:!0}},{key:"custo_unitario",value:{name:"number",required:!0}},{key:"reg_restriction",value:{name:"string",required:!0}},{key:"plant_sap",value:{name:"string",required:!0}},{key:"indication_x",value:{name:"string",required:!0}},{key:"main_technology_cluster",value:{name:"string",required:!0}},{key:"capacidade",value:{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}],required:!0}},{key:"sap_code",value:{name:"string",required:!0}},{key:"indication_y",value:{name:"string",required:!0}},{key:"capability",value:{name:"string",required:!0}},{key:"tech_restriction",value:{name:"string",required:!0}},{key:"cenario",value:{name:"string",required:!0}},{key:"line",value:{name:"string",required:!0}}]}}],raw:"InformationDatabase[]"},description:""},uvps:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string; \r\n  uvpName: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"uvpName",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"UvpItem[]"},description:""},skus:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  skuCode: string;\r\n  skuName: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"skuCode",value:{name:"string",required:!0}},{key:"skuName",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"SkuItem[]"},description:""},skusSites:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  sapCode: string;\r\n  uvpCode: string;\r\n  skuCode: string;\r\n  cenario: string;\r\n  restriction: string;\r\n  tech_restriction: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"sapCode",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"skuCode",value:{name:"string",required:!0}},{key:"cenario",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"tech_restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"SkuItemSites[]"},description:""},uvpChanges:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  uvpName: string;\r\n  sites: SiteItem[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"uvpName",value:{name:"string",required:!0}},{key:"sites",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  sap: string;\r\n  name: string;\r\n  uvp: string;\r\n  restriction: string;\r\n  label: string;\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"sap",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"uvp",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"SiteItem[]",required:!0}}]}}],raw:"UvpChange[]"},description:""},skuChanges:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  open: boolean;\r\n  skus: SkuItemChange[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"open",value:{name:"boolean",required:!0}},{key:"skus",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  skuCode: string;\r\n  skuName?: string;\r\n  cenario: string;\r\n  restriction: string;\r\n  defined_set: { id: string; cenario: string; restriction: string; label: string }[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"skuCode",value:{name:"string",required:!0}},{key:"skuName",value:{name:"string",required:!1}},{key:"cenario",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"defined_set",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ id: string; cenario: string; restriction: string; label: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"cenario",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"{ id: string; cenario: string; restriction: string; label: string }[]",required:!0}}]}}],raw:"SkuItemChange[]",required:!0}}]}}],raw:"SkuChange[]"},description:""},setSkuChanges:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: SkuChange[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  open: boolean;\r\n  skus: SkuItemChange[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"open",value:{name:"boolean",required:!0}},{key:"skus",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\r\n  id: string;\r\n  uvpCode: string;\r\n  skuCode: string;\r\n  skuName?: string;\r\n  cenario: string;\r\n  restriction: string;\r\n  defined_set: { id: string; cenario: string; restriction: string; label: string }[];\r\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"uvpCode",value:{name:"string",required:!0}},{key:"skuCode",value:{name:"string",required:!0}},{key:"skuName",value:{name:"string",required:!1}},{key:"cenario",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"defined_set",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ id: string; cenario: string; restriction: string; label: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"cenario",value:{name:"string",required:!0}},{key:"restriction",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"{ id: string; cenario: string; restriction: string; label: string }[]",required:!0}}]}}],raw:"SkuItemChange[]",required:!0}}]}}],raw:"SkuChange[]"},name:"value"}],return:{name:"void"}}},description:""},regStatus:{required:!0,tsType:{name:"string"},description:""}}},ScenariosUvpSkuView.__docgenInfo={description:"",methods:[],displayName:"ScenariosUvpSkuView"};const UVPSKUPage_stories={title:"Pages/UVPSKUPage",tags:["autodocs"],parameters:{docs:{description:{component:"Página UVP/SKU para gerenciamento de produtos e preços."}}}},Default={render:()=>(0,jsx_runtime.jsx)(ScenariosUvpSkuView,{})},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  render: () => <ScenariosUvpSkuView />\n}",...Default.parameters?.docs?.source}}}},"./src/components/ui/input.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>Input});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_utils_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils/utils.ts");const Input=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({className,type,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("input",{type,className:(0,_utils_utils__WEBPACK_IMPORTED_MODULE_2__.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-md transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",className),ref,...props}));Input.displayName="Input",Input.__docgenInfo={description:"",methods:[],displayName:"Input"}},"./src/components/ui/tooltip.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_v:()=>TooltipContent,aJ:()=>TooltipTrigger,pn:()=>TooltipProvider,u:()=>Tooltip});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@radix-ui/react-tooltip/dist/index.mjs"),_utils_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils/utils.ts");const TooltipProvider=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_3__.zt,Tooltip=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_3__.fC,TooltipTrigger=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_3__.xz,TooltipContent=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({className,sideOffset=4,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_3__.VY,{ref,sideOffset,className:(0,_utils_utils__WEBPACK_IMPORTED_MODULE_2__.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",className),...props}));TooltipContent.displayName=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_3__.VY.displayName,TooltipContent.__docgenInfo={description:"",methods:[],props:{sideOffset:{defaultValue:{value:"4",computed:!1},required:!1}}}},"./src/hooks/useDatabaseInformations.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>useDatabaseInformations});var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),esm=__webpack_require__("./node_modules/zustand/esm/index.mjs"),middleware=__webpack_require__("./node_modules/zustand/esm/middleware.mjs"),informations_database_get_service=__webpack_require__("./src/services/informations-database-get.service.ts"),utils=__webpack_require__("./src/utils/utils.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");const indexedDBStorage=new class IndexedDBStorageImpl{async openDB(){return this.db?this.db:new Promise((resolve,reject)=>{const request=indexedDB.open(this.dbName,this.version);request.onerror=()=>{reject(new Error("Erro ao abrir IndexedDB"))},request.onsuccess=()=>{this.db=request.result,resolve(this.db)},request.onupgradeneeded=event=>{const db=event.target.result;db.objectStoreNames.contains(this.storeName)||db.createObjectStore(this.storeName,{keyPath:"key"})}})}async getItem(key){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((resolve,reject)=>{const request=store.get(key);request.onerror=()=>reject(request.error),request.onsuccess=()=>{const result=request.result;resolve(result?result.value:null)}})}catch(error){return console.error("Erro ao ler do IndexedDB:",error),null}}async setItem(key,value){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((resolve,reject)=>{const request=store.put({key,value,timestamp:Date.now()});request.onerror=()=>reject(request.error),request.onsuccess=()=>{resolve()}})}catch(error){throw console.error("Erro ao salvar no IndexedDB:",error),error}}async removeItem(key){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((resolve,reject)=>{const request=store.delete(key);request.onerror=()=>reject(request.error),request.onsuccess=()=>{resolve()}})}catch(error){throw console.error("Erro ao remover do IndexedDB:",error),error}}async clear(){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((resolve,reject)=>{const request=store.clear();request.onerror=()=>reject(request.error),request.onsuccess=()=>{resolve()}})}catch(error){throw console.error("Erro ao limpar IndexedDB:",error),error}}async getAllKeys(){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((resolve,reject)=>{const request=store.getAllKeys();request.onerror=()=>reject(request.error),request.onsuccess=()=>{resolve(request.result)}})}catch(error){return console.error("Erro ao obter chaves do IndexedDB:",error),[]}}async getStorageInfo(){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((resolve,reject)=>{const request=store.getAll();request.onerror=()=>reject(request.error),request.onsuccess=()=>{const items=request.result;let totalSize=0;items.forEach(item=>{item.value&&(totalSize+=new Blob([item.value]).size)}),resolve({totalSize:Math.round(totalSize/1024/1024*100)/100,itemCount:items.length})}})}catch(error){return console.error("Erro ao obter informações do IndexedDB:",error),{totalSize:0,itemCount:0}}}async cleanOldData(maxAge=6048e5){try{const db=await this.openDB(),store=db.transaction([this.storeName],"readwrite").objectStore(this.storeName),now=Date.now();let cleanedCount=0;return new Promise((resolve,reject)=>{const request=store.getAll();request.onerror=()=>reject(request.error),request.onsuccess=()=>{const items=request.result,deletePromises=[];items.forEach(item=>{try{var _data_state;const data=JSON.parse(item.value);(null===(_data_state=data.state)||void 0===_data_state?void 0:_data_state.lastFetchTime)&&now-data.state.lastFetchTime>maxAge&&(deletePromises.push(this.removeItem(item.key)),cleanedCount++)}catch(error){deletePromises.push(this.removeItem(item.key)),cleanedCount++}}),Promise.all(deletePromises).then(()=>{resolve(cleanedCount)}).catch(reject)}})}catch(error){return console.error("Erro ao limpar dados antigos do IndexedDB:",error),0}}constructor(){this.dbName="MinervaOptimizerDB",this.storeName="storage",this.version=1,this.db=null}},isIndexedDBAvailable=()=>"indexedDB"in window;var database_console=__webpack_require__("./node_modules/console-browserify/index.js");const useDatabaseCache=(0,esm.Ue)()((0,middleware.tJ)((set,get)=>({data:[],lines:[],uvps:[],sites:[],skus:[],skusSites:[],isLoading:!1,lastFetchTime:0,cacheExpiration:3e5,currentSnapshot:null,isValid:()=>{const{lastFetchTime,cacheExpiration}=get();return Date.now()-lastFetchTime<cacheExpiration},fetch:async()=>{const{isValid,data}=get();if(isValid()&&data.length>0)return data;try{set({isLoading:!0});const response=await(0,informations_database_get_service.fL)();if(response.success&&Array.isArray(response.data)){const lines=(0,utils.Nu)(response.data),uvps=(0,utils.JN)(response.data),sites=(0,utils.V7)(response.data),skus=(0,utils.ig)(response.data),skusSites=(0,utils.xN)(response.data);return set({data:response.data,lines,uvps,sites,skus,skusSites,lastFetchTime:Date.now(),isLoading:!1,currentSnapshot:null}),response.data}throw set({isLoading:!1}),new Error(response.message||"Error fetching database data")}catch(error){throw set({isLoading:!1}),database_console.error("Error fetching database data:",error),error}},fetchBySnapshot:async snapshotName=>{try{set({isLoading:!0});const response=await(0,informations_database_get_service.jH)(snapshotName);if(response.success&&Array.isArray(response.data)){const lines=(0,utils.Nu)(response.data),uvps=(0,utils.JN)(response.data),sites=(0,utils.V7)(response.data),skus=(0,utils.ig)(response.data),skusSites=(0,utils.xN)(response.data);return set({data:response.data,lines,uvps,sites,skus,skusSites,lastFetchTime:Date.now(),isLoading:!1,currentSnapshot:snapshotName}),response.data}throw set({isLoading:!1}),new Error(response.message||"Error fetching snapshot database data")}catch(error){throw set({isLoading:!1}),database_console.error("Error fetching snapshot database data:",error),error}},clear:()=>{set({data:[],lines:[],uvps:[],sites:[],skus:[],skusSites:[],isLoading:!1,lastFetchTime:0,currentSnapshot:null})}}),{name:"database-cache",storage:(0,middleware.FL)(()=>({getItem:async name=>{if(!isIndexedDBAvailable())return console.error("IndexedDB não está disponível"),null;try{return await indexedDBStorage.getItem(name)}catch(error){return console.error("Erro ao carregar dados do IndexedDB:",error),null}},setItem:async(name,value)=>{if(!isIndexedDBAvailable())throw new Error("IndexedDB não está disponível");try{await indexedDBStorage.setItem(name,value)}catch(error){throw console.error("Erro ao salvar no IndexedDB:",error),error}},removeItem:async name=>{if(isIndexedDBAvailable())try{await indexedDBStorage.removeItem(name)}catch(error){console.error("Erro ao remover do IndexedDB:",error)}else console.warn("IndexedDB não está disponível para remoção")}}))}));var useDatabaseInformations_console=__webpack_require__("./node_modules/console-browserify/index.js");function useDatabaseInformations(snapshotName){const{data:database,lines,uvps,sites,skus,skusSites,isLoading,fetch,fetchBySnapshot,clear,isValid,currentSnapshot}=useDatabaseCache();(0,react.useEffect)(()=>{(async()=>{try{snapshotName?currentSnapshot===snapshotName&&isValid()&&0!==database.length||await fetchBySnapshot(snapshotName):isValid()&&0!==database.length||await fetch()}catch(error){useDatabaseInformations_console.error("Error loading database data:",error)}})()},[fetch,fetchBySnapshot,isValid,database.length,snapshotName,currentSnapshot]);return{database,isLoading,lines,sites,uvps,skus,skusSites,refresh:async()=>{clear(),snapshotName?await fetchBySnapshot(snapshotName):await fetch()},clearCache:clear,isCacheValid:isValid(),currentSnapshot}}},"./src/store/scenario.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>useScenarioStore});var zustand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/zustand/esm/index.mjs"),zustand_middleware__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/zustand/esm/middleware.mjs");const useScenarioStore=(0,zustand__WEBPACK_IMPORTED_MODULE_0__.Ue)()((0,zustand_middleware__WEBPACK_IMPORTED_MODULE_1__.tJ)(set=>({data:{snapshot:{},scenario:{},uvpsku:{}},view:{snapshot:{},scenario:{},uvpsku:{}},update:newData=>set(state=>({data:{...state.data,...newData}})),reset:()=>set({data:{snapshot:{},scenario:{},uvpsku:{}}}),setView:item=>set(state=>({view:item}))}),{name:"scenario-storage"}))}}]);